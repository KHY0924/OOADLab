@startuml student-submission
!theme plain

title Student Submission Flow

actor Student
participant "StudentPanel" as SP
participant "SubmissionController" as SC
participant "SubmissionDAO" as DAO
database "PostgreSQL" as DB

== Login & View Submissions ==
Student -> SP : Login
SP -> SC : getSubmissionsByStudent(studentId)
SC -> DAO : findByStudentId(studentId)
DAO -> DB : SELECT * FROM submissions WHERE student_id = ?
DB --> DAO : ResultSet
DAO --> SC : List<Submission>
SC --> SP : submissions
SP --> Student : Display submissions list

== Upload Presentation ==
Student -> SP : Click "Upload"
SP -> SP : Show file chooser dialog
Student -> SP : Select file (.pdf/.ppt)
SP -> SC : validateAndUpload(submission, filePath)
SC -> SC : validateUpload(filePath)

alt Valid file type
    SC -> DAO : saveFilePath(submissionId, filePath)
    DAO -> DB : UPDATE submissions SET file_path = ?
    DB --> DAO : Success
    DAO --> SC : true
    SC --> SP : "Upload successful"
    SP --> Student : Show success message
else Invalid file type
    SC --> SP : "Invalid file format"
    SP --> Student : Show error message
end

== Edit Submission (Check Deadline) ==
Student -> SP : Click "Edit"
SP -> SC : canEdit(submissionId)
SC -> DAO : getSubmission(submissionId)
DAO -> DB : SELECT deadline FROM submissions
DB --> DAO : deadline
DAO --> SC : Submission

alt Before deadline
    SC --> SP : true (editable)
    SP -> SP : Show edit dialog
    Student -> SP : Update title & abstract
    SP -> SC : updateSubmission(id, title, abstract)
    SC -> DAO : update(submission)
    DAO -> DB : UPDATE submissions SET title = ?, abstract_text = ?
    DB --> DAO : Success
    DAO --> SC : true
    SC --> SP : "Update successful"
else After deadline
    SC --> SP : false (not editable)
    SP --> Student : "Deadline passed. Cannot edit."
end

@enduml
